var CryptoJS=CryptoJS||function(m,q){var h={},d=h.lib={},k=function(){},a=d.Base={extend:function(b){k.prototype=this;var g=new k;b&&g.mixIn(b);g.hasOwnProperty("init")||(g.init=function(){g.$super.init.apply(this,arguments)});g.init.prototype=g;g.$super=this;return g},create:function(){var b=this.extend();b.init.apply(b,arguments);return b},init:function(){},mixIn:function(b){for(var g in b)b.hasOwnProperty(g)&&(this[g]=b[g]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}},
e=d.WordArray=a.extend({init:function(b,g){b=this.words=b||[];this.sigBytes=g!=q?g:4*b.length},toString:function(b){return(b||f).stringify(this)},concat:function(b){var g=this.words,e=b.words,l=this.sigBytes;b=b.sigBytes;this.clamp();if(l%4)for(var a=0;a<b;a++)g[l+a>>>2]|=(e[a>>>2]>>>24-a%4*8&255)<<24-(l+a)%4*8;else if(65535<e.length)for(a=0;a<b;a+=4)g[l+a>>>2]=e[a>>>2];else g.push.apply(g,e);this.sigBytes+=b;return this},clamp:function(){var b=this.words,g=this.sigBytes;b[g>>>2]&=4294967295<<32-
g%4*8;b.length=m.ceil(g/4)},clone:function(){var b=a.clone.call(this);b.words=this.words.slice(0);return b},random:function(b){for(var g=[],a=0;a<b;a+=4)g.push(4294967296*m.random()|0);return new e.init(g,b)}}),c=h.enc={},f=c.Hex={stringify:function(b){var g=b.words;b=b.sigBytes;for(var a=[],e=0;e<b;e++){var f=g[e>>>2]>>>24-e%4*8&255;a.push((f>>>4).toString(16));a.push((f&15).toString(16))}return a.join("")},parse:function(b){for(var a=b.length,f=[],l=0;l<a;l+=2)f[l>>>3]|=parseInt(b.substr(l,2),16)<<
24-l%8*4;return new e.init(f,a/2)}},r=c.Latin1={stringify:function(b){var a=b.words;b=b.sigBytes;for(var e=[],f=0;f<b;f++)e.push(String.fromCharCode(a[f>>>2]>>>24-f%4*8&255));return e.join("")},parse:function(b){for(var a=b.length,f=[],l=0;l<a;l++)f[l>>>2]|=(b.charCodeAt(l)&255)<<24-l%4*8;return new e.init(f,a)}},z=c.Utf8={stringify:function(b){try{return decodeURIComponent(escape(r.stringify(b)))}catch(a){throw Error("Malformed UTF-8 data");}},parse:function(b){return r.parse(unescape(encodeURIComponent(b)))}},
C=d.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new e.init;this._nDataBytes=0},_append:function(b){"string"==typeof b&&(b=z.parse(b));this._data.concat(b);this._nDataBytes+=b.sigBytes},_process:function(b){var a=this._data,f=a.words,l=a.sigBytes,r=this.blockSize,c=l/(4*r),c=b?m.ceil(c):m.max((c|0)-this._minBufferSize,0);b=c*r;l=m.min(4*b,l);if(b){for(var k=0;k<b;k+=r)this._doProcessBlock(f,k);k=f.splice(0,b);a.sigBytes-=l}return new e.init(k,l)},clone:function(){var b=a.clone.call(this);
b._data=this._data.clone();return b},_minBufferSize:0});d.Hasher=C.extend({cfg:a.extend(),init:function(b){this.cfg=this.cfg.extend(b);this.reset()},reset:function(){C.reset.call(this);this._doReset()},update:function(b){this._append(b);this._process();return this},finalize:function(b){b&&this._append(b);return this._doFinalize()},blockSize:16,_createHelper:function(b){return function(a,e){return(new b.init(e)).finalize(a)}},_createHmacHelper:function(b){return function(a,e){return(new u.HMAC.init(b,
e)).finalize(a)}}});var u=h.algo={};return h}(Math);
(function(){var m=CryptoJS,q=m.lib,h=q.WordArray,d=q.Hasher,k=[],q=m.algo.SHA1=d.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,e){for(var c=this._hash.words,f=c[0],r=c[1],d=c[2],h=c[3],u=c[4],b=0;80>b;b++){if(16>b)k[b]=a[e+b]|0;else{var g=k[b-3]^k[b-8]^k[b-14]^k[b-16];k[b]=g<<1|g>>>31}g=(f<<5|f>>>27)+u+k[b];g=20>b?g+((r&d|~r&h)+1518500249):40>b?g+((r^d^h)+1859775393):60>b?g+((r&d|r&h|d&h)-1894007588):g+((r^d^
h)-899497514);u=h;h=d;d=r<<30|r>>>2;r=f;f=g}c[0]=c[0]+f|0;c[1]=c[1]+r|0;c[2]=c[2]+d|0;c[3]=c[3]+h|0;c[4]=c[4]+u|0},_doFinalize:function(){var a=this._data,e=a.words,d=8*this._nDataBytes,f=8*a.sigBytes;e[f>>>5]|=128<<24-f%32;e[(f+64>>>9<<4)+14]=Math.floor(d/4294967296);e[(f+64>>>9<<4)+15]=d;a.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var a=d.clone.call(this);a._hash=this._hash.clone();return a}});m.SHA1=d._createHelper(q);m.HmacSHA1=d._createHmacHelper(q)})();
(function(){var m=CryptoJS,q=m.enc.Utf8;m.algo.HMAC=m.lib.Base.extend({init:function(h,d){h=this._hasher=new h.init;"string"==typeof d&&(d=q.parse(d));var k=h.blockSize,a=4*k;d.sigBytes>a&&(d=h.finalize(d));d.clamp();for(var e=this._oKey=d.clone(),c=this._iKey=d.clone(),f=e.words,r=c.words,z=0;z<k;z++)f[z]^=1549556828,r[z]^=909522486;e.sigBytes=c.sigBytes=a;this.reset()},reset:function(){var h=this._hasher;h.reset();h.update(this._iKey)},update:function(h){this._hasher.update(h);return this},finalize:function(h){var d=
this._hasher;h=d.finalize(h);d.reset();return d.finalize(this._oKey.clone().concat(h))}})})();
(function(){var m=CryptoJS,q=m.lib.WordArray;m.enc.Base64={stringify:function(h){var d=h.words,k=h.sigBytes,a=this._map;h.clamp();h=[];for(var e=0;e<k;e+=3)for(var c=(d[e>>>2]>>>24-e%4*8&255)<<16|(d[e+1>>>2]>>>24-(e+1)%4*8&255)<<8|d[e+2>>>2]>>>24-(e+2)%4*8&255,f=0;4>f&&e+0.75*f<k;f++)h.push(a.charAt(c>>>6*(3-f)&63));if(d=a.charAt(64))for(;h.length%4;)h.push(d);return h.join("")},parse:function(h){var d=h.length,k=this._map,a=k.charAt(64);a&&(a=h.indexOf(a),-1!=a&&(d=a));for(var a=[],e=0,c=0;c<d;c++)if(c%
4){var f=k.indexOf(h.charAt(c-1))<<c%4*2,r=k.indexOf(h.charAt(c))>>>6-c%4*2;a[e>>>2]|=(f|r)<<24-e%4*8;e++}return q.create(a,e)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();this.JSON||(this.JSON={});
(function(){function m(a){return 10>a?"0"+a:a}function q(a){k.lastIndex=0;return k.test(a)?'"'+a.replace(k,function(a){var e=c[a];return"string"===typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function h(d,k){var c,u,b,g,m=a,l,p=k[d];p&&"object"===typeof p&&"function"===typeof p.toJSON&&(p=p.toJSON(d));"function"===typeof f&&(p=f.call(k,d,p));switch(typeof p){case "string":return q(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";a+=e;l=[];if("[object Array]"===Object.prototype.toString.apply(p)){g=p.length;for(c=0;c<g;c+=1)l[c]=h(c,p)||"null";b=0===l.length?"[]":a?"[\n"+a+l.join(",\n"+a)+"\n"+m+"]":"["+l.join(",")+"]";a=m;return b}if(f&&"object"===typeof f)for(g=f.length,c=0;c<g;c+=1)u=f[c],"string"===typeof u&&(b=h(u,p))&&l.push(q(u)+(a?": ":":")+b);else for(u in p)Object.hasOwnProperty.call(p,u)&&(b=h(u,p))&&l.push(q(u)+(a?": ":":")+b);b=0===l.length?"{}":a?"{\n"+a+l.join(",\n"+a)+"\n"+
m+"}":"{"+l.join(",")+"}";a=m;return b}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+m(this.getUTCMonth()+1)+"-"+m(this.getUTCDate())+"T"+m(this.getUTCHours())+":"+m(this.getUTCMinutes())+":"+m(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
k=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,e,c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},f;"function"!==typeof JSON.stringify&&(JSON.stringify=function(c,d,k){var m;e=a="";if("number"===typeof k)for(m=0;m<k;m+=1)e+=" ";else"string"===typeof k&&(e=k);if((f=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return h("",{"":c})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,e){function f(a,c){var d,k,h=a[c];if(h&&"object"===typeof h)for(d in h)Object.hasOwnProperty.call(h,d)&&(k=f(h,d),void 0!==k?h[d]=k:delete h[d]);return e.call(a,c,h)}var c;a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+a+")"),"function"===typeof e?f({"":c},""):c;throw new SyntaxError("JSON.parse");})})();
var Scoreflex=function(m,q,h){var d;d={inArray:function(d,a){for(var e=0;e<a.length;e++)if(a[e]===d)return!0;return!1},rawurlencode:function(d){d=(d+"").toString();return encodeURIComponent(d).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},getUUID:function(){var d=Array(31);if(window.crypto&&crypto.getRandomValues){var a=new Uint8Array(31);crypto.getRandomValues(a);for(var e=0;31>e;e++)d[e]=a[e]&15}else for(e=0;31>e;e++)d[e]=16*Math.random()|
0;var c=0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var e=d[c++];return("x"==a?e:e&3|8).toString(16)})},getDeviceId:function(){var d;window.localStorage&&(d=localStorage.getItem("deviceId"));d||(d=this.getUUID()+"-"+(+new Date).toString(16),window.localStorage&&localStorage.setItem("deviceId",d));return d},fireEvent:function(d,a,e){var c;if(document.createEventObject)return c=document.createEventObject(),c.data=e,d.fireEvent("on"+a,c);c=new CustomEvent(a,{detail:e,bubbles:!0,
cancelable:!0});return!d.dispatchEvent(c)}};return function(h,a,e){var c="af ar be bg bn ca cs da de el en en_GB en_US es es_ES es_MX et fa fi fr fr_FR fr_CA he hi hr hu id is it ja ko lt lv mk ms nb nl pa pl pt pt_PT pt_BR ro ru sk sl sq sr sv sw ta th tl tr uk vi zh zh_CN zh_TW zh_HK".split(" "),f=!1,m=Scoreflex.SessionState.INIT_UNSTARTED,q=null,C=null,u=!0,b=function(){var a=function(a,b){var d=new XMLHttpRequest;"withCredentials"in d?d.open(a,b,!0):"undefined"!=typeof XDomainRequest?(d=new XDomainRequest,
d.open(a,b)):d=null;return d},b=function(a,b){return a.k==b.k?a.v<b.v?-1:1:a.k<b.k?-1:1};return{request:function(b,d,e,c,f,s){var w=a(b,d);if(void 0!==f)for(var y in f)w.setRequestHeader(y,f[y]);if(w){if(s)for(y=["onerror","ontimeout","onabort","onloadend"],d=0;d<y.length;d++)s[y[d]]&&(w[y[d]]=s[y[d]]);w.onload=function(){if(s){try{var a;a:{try{a=JSON.parse(this.responseText);break a}catch(b){}a=null}w.responseJSON=a}catch(d){}200==this.status&&s.onload?s.onload.apply(this,arguments):s.onerror&&s.onerror.apply(this,
arguments)}};"POST"===b?w.send(e):w.send()}},getSignature:function(a,e,n,t){void 0===t&&(t="");void 0===n&&(n=[]);var f,c=document.createElement("a");c.href=e;e=c.protocol.substr(0,c.protocol.length-1).toLowerCase();var h=c.hostname.toLowerCase(),y=c.pathname,c=c.search;0<c.length&&"?"===c[0]&&(c=c.substr(1));var c=c.split("&"),g=[],l;for(f=0;f<c.length;f++)""!==c[f]&&(l=c[f].split("=",2),g.push({k:l[0],v:l[1]}));var c=d.rawurlencode,k;for(k in n)g.push({k:c(k),v:c(n[k])});g.sort(b);n=[];for(f=0;f<
g.length;f++)n.push(g[f].k+"="+g[f].v);n=n.join("&");a=a+"&"+c(e+"://"+h+y)+"&"+c(n)+"&"+c(t);a=CryptoJS.HmacSHA1(a,C).toString(CryptoJS.enc.Base64);return'Scoreflex sig="'+c(a)+'", meth="0"'}}}(),g={ScoreflexSessionEvent:function(){return{name:"session",state:m}},ScoreflexPlayerEvent:function(){var a=A()||{};return{name:"player",player:a.me,anonymous:a.anonymous}},ScoreflexPlayEvent:function(a){return{name:"play",leaderboard:a}},ScoreflexChallengeEvent:function(a){return{name:"challenge",challenge:a}},
fire:function(a){d.fireEvent(window,"ScoreflexEvent",a)}},x=function(){var a=function(a){return(u?"https://sandbox.api.scoreflex.com":"https://api.scoreflex.com")+"/v1"+a},e=function(a){void 0===a&&(a={});var b=A()||{},e=b.lang||window.navigator.language;a.lang=d.inArray(e,c)?e:"en";b.accessToken&&(a.accessToken=b.accessToken);return a},f=function(a){var b=[],d;for(d in a)b.push(encodeURIComponent(d)+"="+encodeURIComponent(a[d]));return b.join("&")};return{post:function(d,c,h,g){c=e(c);d=a(d);var l=
f(c);c={"Content-type":"application/x-www-form-urlencoded","X-Scoreflex-Authorization":b.getSignature("POST",d,c,h)};b.request("POST",d,l,h,c,g)},get:function(d,c,h){c=e(c);d=a(d);(c=f(c))&&(d=d+"?"+c);b.request("GET",d,{},void 0,{},h)}}}(),l=function(){var a={},b={},e=[],h=function(d){if(!a[d]){var c=document.createElement("iframe");c.id="scoreflexWebClient_"+d;a[d]=c;c.onload=function(){b[d]=c.contentWindow}}return a[d]},n=function(a){for(var b=0;b<e.length;b++)if(e[b]===a){e.splice(b,1);break}},
k=null;window.addEventListener("message",function(a){if("https://api.scoreflex.com"==a.origin||"https://sandbox.api.scoreflex.com"==a.origin){var c=a.data;if(c!==k){k=c;var e=document.createElement("a");e.href=c;if("/v1/web/callback"==e.pathname){c=e.search;0<c.length&&"?"==c[0]&&(c=c.substr(1));var e=c.split("&"),c={},h,t,n;for(t=0;t<e.length;t++)e[t]&&(h=e[t].split("=",2),c[h[0]]=h[1]);e=null;for(n in b)if(a.source===b[n]){e=n;break}a=e;e=c.code;n=c.data?JSON.parse(decodeURIComponent(c.data)):{};
switch(e){case "200000":s(a);E(null,!0);H();break;case "200001":s(a);break;case "200002":g.fire(g.ScoreflexPlayEvent(I.get(n.leaderboardId)));s(a);break;case "200003":s(a);f&&(a=A(),!0===a.anonymous&&(n={clientId:q,devicePlatform:"Web",deviceModel:window.navigator.userAgent||"browser",deviceId:d.getDeviceId(),state:J(!0)},a.accessToken&&(n.anonymousAccessToken=a.accessToken,n.forceMerge="true"),n=v(n,void 0),l.show("/oauth/web/authorize",n,void 0,{style:"full",noSid:!0})));break;case "200004":c=n.code;
n=n.state;s(a);L({code:c,state:n});break;case "200005":c=n.url;n=n.mode;s(a);m(c,{},{style:n});break;case "200006":s(a);break;case "200007":c=n.challengeInstanceId;n=n.challengeConfigId;s(a);g.fire(g.ScoreflexChallengeEvent(K.get(c,n)));break;case "200008":s(a);break;case "200009":s(a);break;case "200010":s(a)}}}}},!1);var m=function(a,b,f,t){f=f||{};if(void 0!==t)for(var g in t)void 0===f[g]&&(f[g]=t[g]);t=b;if(-1!==a.indexOf("://"))b=a;else if(b=u,A().sid){g=f;void 0===t&&(t={});void 0===g&&(g=
{});var w=A()||{},l=w.lang||window.navigator.language;t.lang=d.inArray(l,c)?l:"en";w.sid&&!g.noSid&&(t.sid=w.sid);g=[];for(var k in t)g.push(encodeURIComponent(k)+"="+encodeURIComponent(t[k]));k=g.join("&");b=(b?"https://sandbox.api.scoreflex.com":"https://api.scoreflex.com")+"/v1"+a+"?"+k}else b=null;b?(a=f.id||f.style||"full",k=h(a),k.src=b+"#start",f="scoreflexWebClient_"+f.style,void 0!==f&&(b=k.getAttribute("data-stylename"),b!==f&&(k.classList.remove(b),k.classList.add(f),k.setAttribute("data-stylename",
f))),document.body.appendChild(k),n(a),e.push(a)):s()},s=function(a){var b;a||(a=0<e.length?e[e.length-1]:null);a&&(b=h(a))&&b.parentNode&&(b.parentNode.removeChild(b),n(a))};return{show:m,close:s}}(),p=function(){var a="SFX_"+h+"_"+(e?"1":"0");return{get:function(b){return(b=localStorage.getItem(a+b))?JSON.parse(b):null},set:function(b,c){var d=JSON.stringify(c);return localStorage.setItem(a+b,d)},rm:function(b){return localStorage.removeItem(a+b)}}}(),B=function(a,b){var c=function(){return b||
{}},d=function(a){return c()[a]};return{getId:function(){return a},getData:c,setData:function(a){b=a},getValue:d,getNickname:function(){return d("nickName")||""},getAvatarUrl:function(){var b=d("avatarUrl");return b?b:"https://www.scoreflex.com/"+(u?"sandbox/":"")+"avatars/players/"+a+"/"},getGeo:function(a){var b=d("geo")||{};return void 0!==a?b[a]||"":b},showProfile:function(b,c){D.showProfile(a,b,c)},showFriends:function(b,c){showPlayerFriends(a,b,c)}}},D=function(){var a={};return{get:function(b,
c,d,e){if(f)if(void 0===d&&(d={}),!e&&a[b]){if(d.onload){var g=B(b,a[b]);setTimeout(function(){d.onload.call(null,g)},0)}}else{var h=d.onload;d.onload=function(){var c=this.responseJSON||{};a[b]=c;c=B(b,c);h.call(this,c)};x.get("/players/"+b,c,d)}},getCurrent:function(){var a=(A()||{}).me||{};return B(a.id,a)},showProfile:function(a,b,c){f&&(void 0===a&&(a="me"),b=v({},b),l.show("/web/players/"+a,b,c,{style:"full"}))},showFriends:function(a,b,c){f&&(void 0===a&&(a="me"),b=v({},b),l.show("/web/players/"+
a+"/friends",b,c,{style:"full"}))}}}(),M=function(a){var b=function(b,c,d){f&&(b={score:b},b=v(b,c),x.post("/scores/"+a,b,void 0,d))},c=function(b,c){if(f){var d=v({},b);l.show("/web/scores/"+a+"/ranks",d,c,{style:"panel"})}};return{getId:function(){return a},submitScore:b,show:function(b,c){if(f){var d=v({},b);l.show("/web/leaderboards/"+a,d,c,{style:"full"})}},showOverview:function(b,c){if(f){var d=v({},b);l.show("/web/leaderboards/"+a+"/overview",d,c,{style:"full"})}},showRankbox:c,submitScoreAndShowRankbox:function(a,
d,e){b(a,d);d=d||{};d.score=a;c(d,e)}}},I=function(){return{get:function(a){return M(a)}}}(),N=function(a,b){var c=null,d=function(b,c){if(f){var d=v(d,b);x.get("/challenges/instances/"+a,d,c)}},e=function(b,c,g){if(f)if(b&&void 0!==b.turnSequence){var h={body:JSON.stringify(b)},h=v(h,c);x.post("/challenges/instances/"+a+"/turns",h,void 0,g)}else d({fields:"turn"},{onload:function(){var a=b||{};a.turnSequence=((this.responseJSON||{}).turn||{}).sequence||0;e(a,c,g)},onerror:(g||{}).onerror})};return{getInstanceId:function(){return a},
getConfigId:function(){return b},getDetails:d,getPlayers:function(a,b,e){void 0===b&&(b={});e||null===cache_participants?d(a,{onload:function(){var a=(this.responseJSON||{}).participants||{},d={},e=0,f=0,g;for(g in a)e++,d[g]=B(g,{});var h=function(a){f++;a.id&&(d[a.id]=B(a.id,a));f>=e&&(c=d,setTimeout(function(){b.onload.call(null,d)},0))};for(g in a)D.get(g,{},{onload:function(){h(this.responseJSON||{})}})},onerror:function(){b.onerror&&handler.onerror.apply(this,arguments)}}):b.onload&&setTimeout(function(){b.onload.call(null,
c)},0)},getTurns:function(b,c){if(f){var d=v(d,b);x.get("/challenges/instances/"+a+"/turns",d,c)}},submitTurn:e,submitTurnScore:function(a,b,c){e({score:a},b,c)},showDetails:function(b,c){if(f){var d=v({},b);l.show("/web/challenges/instances/"+a,d,c,{style:"full"})}}}},K=function(){return{showChallenges:function(a,b){if(f){var c=v({},a);l.show("/web/challenges",c,b,{style:"full"})}},get:function(a,b){return N(a,b)}}}(),A=function(){var a=p.get("sessions");a||(a={});return a.player?a.player:a.anonymous},
E=function(a,b){var c=p.get("sessions");c||(c={});!0===b?c.player=a:c.anonymous=a;p.set("sessions",c)},F=function(a){m=a;g.fire(g.ScoreflexSessionEvent())},G=null,J=function(a){if(!0===a||null===G)G="S"+ +new Date;return G},v=function(a,b){void 0===a&&(a={});if(void 0!==b)for(var c in b)a[c]=b[c];return a},O=function(a){var b={clientId:q,devicePlatform:"Web",deviceModel:window.navigator.userAgent||"browser",deviceId:d.getDeviceId()};x.post("/oauth/anonymousAccessToken",b,void 0,a)},H=function(a,b){var c=
A(),d={onload:function(){var b=this.responseJSON||{},c=(b.accessToken||{}).token||null,d=b.sid||null,b=b.me||{},e=b.id||null,f=b.language||null;c&&d&&e&&E({anonymous:!0,accessToken:c,sid:d,playerId:e,lang:f,me:b},!1);g.fire(g.ScoreflexPlayerEvent());a&&a()},onerror:function(){b&&b()}};c&&c.accessToken&&c.sid&&c.playerId?d.onload&&setTimeout(d.onload,0):O(d)},L=function(a){a.state===J()&&x.post("/oauth/accessToken",{code:a.code,clientId:q},void 0,{onload:function(){var a=this.responseJSON||{},b=(a.accessToken||
{}).token||null,c=a.sid||null,a=a.me||{},d=a.id||null,e=a.language||null;b&&c&&d&&(E({anonymous:!1,accessToken:b,sid:c,playerId:d,lang:e,me:a},!0),E(null,!1));D.showProfile();g.fire(g.ScoreflexPlayerEvent())},onerror:function(){}})};(function(a,b,c){f||(q=a,C=b,u=c,F(Scoreflex.SessionState.INIT_INPROGRESS),H(function(){f=!0;F(Scoreflex.SessionState.INIT_SUCCESS)},function(){F(Scoreflex.SessionState.INIT_FAILED)}))})(h,a,e);return{reset:function(){p.rm("sessions")},getSessionState:function(){return m},
RestClient:x,ping:function(a){x.get("/network/ping",{},a)},WebClient:l,Leaderboards:I,Players:D,Challenges:K}}(m,q,h)};Scoreflex.SessionState={INIT_FAILED:-1,INIT_UNSTARTED:0,INIT_INPROGRESS:1,INIT_SUCCESS:2};
